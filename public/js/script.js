var controller,prevElement,w=window.innerWidth,size=w>=1024?"big":"small",halfScreen=.5*window.innerHeight,threeQuarterScreen=.75*window.innerHeight,oneFifthScreenHeight=.2*window.innerHeight;function stepAnimation(){var e=gsap.timeline();return e.from(".panel.step-two",1,{xPercent:0}),e.from(".panel.step-three",1,{xPercent:0}),e.from(".panel.step-four",1,{xPercent:0}),new ScrollMagic.Scene({triggerElement:"#pinMaster",triggerHook:"onLeave",duration:"200%"}).setPin("#pinMaster").setTween(e).addTo(controller)}function tokenAnimation(){const e=gsap.timeline();return e.to("#fade1",1,{opacity:0}).to("#fade1",1,{opacity:1}).to("#fade1",1,{opacity:1}),e.to("#fade2",1,{opacity:0}).to("#fade2",1,{opacity:1}),e.to("#fade3",1,{opacity:0}).to("#fade3",1,{opacity:1}),new ScrollMagic.Scene({triggerElement:"#token-trigger",triggerHook:"onLeave",duration:"45%",offset:-halfScreen}).setTween(e).setClassToggle("#token-trigger","active").addTo(controller)}function cityAnimation(){var e=gsap.timeline();return e.from("#city-trigger",1,{xPercent:0,opacity:1}),new ScrollMagic.Scene({triggerElement:"#city-trigger",triggerHook:"onLeave",duration:"0%",offset:-threeQuarterScreen}).setTween(e).setClassToggle("#city-trigger","active").addTo(controller)}function buildingAnimation(){const e=gsap.timeline();return e.from("#building-trigger",1,{xPercent:0,opacity:1}),new ScrollMagic.Scene({triggerElement:"#building-trigger",triggerHook:"onLeave",duration:"0%",offset:-halfScreen}).setTween(e).setClassToggle("#building-trigger","active").addTo(controller)}function integrateAnimation(){const e=gsap.timeline();return e.from(".integrate-section",1,{xPercent:0,opacity:1}),new ScrollMagic.Scene({triggerElement:".integrate-section",triggerHook:"onLeave",duration:"0%",offset:-oneFifthScreenHeight}).setTween(e).setClassToggle(".integrate-section","active").addTo(controller)}function updateActiveStep(e){const t=document.querySelectorAll("#pinMaster .panel"),i=t[0];i&&(t.forEach(e=>{e.classList.remove("inactive"),e.classList.remove("active")}),i.classList.remove("stage-one"),i.classList.remove("stage-two"),i.classList.remove("stage-three"),i.classList.remove("stage-four"),0===e&&(t[0].classList.remove("start"),i.classList.remove("stage-one")),e>0&&t[0].classList.add("start"),e<.2&&0!==e&&(t[0].classList.add("active"),i.classList.add("stage-one")),e>.2&&e<=.5&&(t[1].classList.add("active"),i.classList.add("stage-two")),e>.5&&e<=.7&&(t[2].classList.add("active"),i.classList.add("stage-three")),e>.7&&(t[3].classList.add("active"),i.classList.add("stage-four")),t.forEach((e,i)=>{const n=t[i+1];e.classList.contains("active")&&n&&n.classList.add("inactive")}))}function isMobile(){return window.innerWidth<1024}function initialiseScrollMagic(){controller=new ScrollMagic.Controller;const e=stepAnimation();tokenAnimation(),cityAnimation(),buildingAnimation(),integrateAnimation();document.addEventListener("scroll",function(){updateActiveStep(e.progress())})}function handleResize(){setTimeout(function(){isSafari()||$.stellar("refresh");const e=isMobile()?"small":"big";e!==size&&(size=e,"small"===e?controller.destroy(!0):initialiseScrollMagic())},400)}function isSafari(){const e=window.navigator,t=e.userAgent.toLowerCase(),i=!(!e.mediaCapabilities||!e.mediaCapabilities.decodingInfo);return-1!==t.indexOf("safari")&&!(-1!==t.indexOf("chrome"))&&-1!==t.indexOf("version/")&&i}function initialiseElements(){document.title.includes("Home")?(isMobile()||initialiseScrollMagic(),$.stellar({horizontalScrolling:!1,responsive:!0,positionProperty:"transform",parallaxElements:!0,verticalOffset:isSafari()?-threeQuarterScreen:0}),window.addEventListener("resize",function(){handleResize()})):(controller&&controller.destroy(!0),window.removeEventListener("resize",function(){handleResize()},!0),document.removeEventListener("scroll",updateActiveStep,!0))}window.addEventListener("popstate",initialiseElements());